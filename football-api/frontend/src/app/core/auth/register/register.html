  <div class="wrap">
    <h1>Crear cuenta</h1>
    <p class="sub">Registrate para empezar a usar la app.</p>

    @if(error()){ <div class="alert">{{ error() }}</div> }

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="row">
        <label for="name">Nombre</label>
        <input id="name" type="text" formControlName="name" placeholder="Tu nombre" autocomplete="name" />
        @if(touched('name') && hasErr('name','required')){ <div class="error">El nombre es requerido.</div> }
        @if(touched('name') && hasErr('name','minlength')){ <div class="error">Mínimo 2 caracteres.</div> }
      </div>

      <div class="row">
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email" placeholder="tucorreo@ejemplo.com" autocomplete="email" />
        @if(touched('email') && hasErr('email','required')){ <div class="error">El email es requerido.</div> }
        @if(touched('email') && hasErr('email','email')){ <div class="error">Formato de email inválido.</div> }
      </div>

      <div class="row" formGroupName="passwords">
        <label for="password">Contraseña</label>
        <input id="password" type="password" formControlName="password" placeholder="••••••••" autocomplete="new-password" />
        @if(touched('passwords.password') && hasErr('passwords.password','required')){ <div class="error">La contraseña es requerida.</div> }
        @if(touched('passwords.password') && hasErr('passwords.password','minlength')){ <div class="error">Mínimo 8 caracteres.</div> }
        @if(touched('passwords.password') && hasErr('passwords.password','pattern')){ 
          <div class="error">Debe incluir mayúscula, minúscula y número.</div> 
        }

        <label for="confirm">Confirmar contraseña</label>
        <input id="confirm" type="password" formControlName="confirm" placeholder="Repite la contraseña" autocomplete="new-password" />
        @if(touched('passwords.confirm') && hasErr('passwords','mustMatch')){ <div class="error">Las contraseñas no coinciden.</div> }
      </div>

      <div class="checkbox">
        <input id="terms" type="checkbox" formControlName="terms"/>
        <label for="terms" class="muted">Acepto los términos y condiciones.</label>
      </div>
      @if(touched('terms') && hasErr('terms','required')){ <div class="error">Debes aceptar los términos.</div> }

      <div class="actions">
        <a class="btn btn-ghost" routerLink="/login">¿Ya tienes cuenta? Inicia sesión</a>
        <button class="btn btn-primary" type="submit" [disabled]="form.invalid || loading()">
          @if(loading()){ Registrando... } @else { Crear cuenta }
        </button>
      </div>
    </form>

    @if(success()){ <p class="ok" style="margin-top:1rem;">Registro exitoso. Redirigiendo...</p> }
  </div>
